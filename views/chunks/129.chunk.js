webpackJsonp([129],{1048:function(e,t){},1229:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contain-main"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",[a("el-input",{attrs:{size:"small",placeholder:"关键字搜索"},model:{value:e.formData.keywords,callback:function(t){e.formData.keywords=t},expression:"formData.keywords"}})],1),e._v(" "),a("el-input",{staticClass:"displayNone"}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"search",size:"small"},on:{click:e.searchFun}},[e._v("搜索")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.tableData}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.row.unitList,"show-header":!1}},[a("el-table-column",{attrs:{prop:"unitName",label:"楼栋","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"managerRealName",label:"管家","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"managerCellphone",label:"联系方式","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permit",rawName:"v-permit",value:402,expression:"402"}],attrs:{type:"primary",size:"small",icon:"my-people"},on:{click:function(a){e.handleDistributeBuildingManager(t.row)}}},[e._v("分配管家")])]}}])})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"buildingName",label:"楼栋","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"buildingManager",label:"管家","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"cellphone",label:"联系方式","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permit",rawName:"v-permit",value:402,expression:"402"}],attrs:{type:"primary",size:"small",icon:"my-people"},on:{click:function(a){e.handleDistributeBuildingManager(t.row)}}},[e._v("分配管家")])]}}])})],1),e._v(" "),a("div",[a("div",{staticClass:"contain-bottom-pagination"},[a("el-pagination",{staticClass:"fr",attrs:{layout:"sizes, total, prev, pager, next, jumper","current-page":e.pageData.currentPage,total:e.pageData.totalSize,"page-sizes":[10,20,50,100],"page-size":e.pageData.pageSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("el-dialog",{attrs:{title:"选择员工",visible:e.distributeBuildingManagerDialogVisible,size:"tiny"},on:{"update:visible":function(t){e.distributeBuildingManagerDialogVisible=t},close:e.handleResetDistributeBuildingManager}},[a("el-form",{ref:"distributeBuildingManagerForm",attrs:{model:e.distributeBuildingManagerFormData,rules:e.distributeBuildingManagerFormRules}},[a("el-form-item",{attrs:{prop:"chooseManager"}},[a("el-select",{style:{width:"100%"},attrs:{filterable:""},model:{value:e.distributeBuildingManagerFormData.chooseManager,callback:function(t){e.distributeBuildingManagerFormData.chooseManager=t},expression:"distributeBuildingManagerFormData.chooseManager"}},e._l(e.managerList,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}))],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{on:{click:e.handleCloseDistributeBuildingManager}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitDistributeBuildingManager}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},381:function(e,t,a){function i(e){a(1048)}var n=a(65)(a(892),a(1229),i,"data-v-4333f5b6",null);e.exports=n.exports},892:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{tableData:[],formData:{keywords:""},sendData:{keywords:""},pageData:{currentPage:void 0!==this.$route.query.currentPage?parseInt(this.$route.query.currentPage):1,totalSize:1,pageSize:10},distributeBuildingManagerDialogVisible:!1,distributeBuildingManagerFormData:{buildingId:"",chooseManager:""},distributeBuildingManagerFormRules:{chooseManager:[{type:"number",required:!0,message:"请选择一名管理员",trigger:"blur"}]},managerList:[]}},methods:{watchQueryFun:function(){this.$route.query.currentPage?this.pageData.currentPage=parseInt(this.$route.query.currentPage):this.pageData.currentPage=1,this.ajaxFun()},ajaxFun:function(){var e=this;this.$http({url:"/api/manageSystem/system/manager/building/getBuildingList",params:{keywords:this.sendData.keywords,pageNo:this.pageData.currentPage,pageSize:this.pageData.pageSize}}).then(function(t){"00000"===t.data.code&&(e.pageData.totalSize=t.data.count,e.tableData=t.data.buildingList)}).catch(function(e){console.log(e)})},searchFun:function(){this.sendData.keywords=this.formData.keywords,this.$route.query.currentPage?this.$router.push({path:"/manageSystem/manager/building"}):this.$router.push({path:"/manageSystem/manager/building",query:{currentPage:1}})},handleSizeChange:function(e){this.pageData.pageSize=e,this.$route.query.currentPage?this.$router.push({path:"/manageSystem/manager/building"}):this.$router.push({path:"/manageSystem/manager/building",query:{currentPage:1}})},handleCurrentChange:function(e){this.$router.push({path:"/manageSystem/manager/building",query:{currentPage:e}})},getSimpleManagerList:function(){var e=this;this.$http({url:"/api/manageSystem/system/manager/manager/getSimpleManagerList"}).then(function(t){"00000"===t.data.code&&(e.managerList=t.data.managerList)}).catch(function(e){console.log(e)})},handleResetDistributeBuildingManager:function(){this.$refs.distributeBuildingManagerForm.resetFields()},handleCloseDistributeBuildingManager:function(){this.distributeBuildingManagerDialogVisible=!1},handleSubmitDistributeBuildingManager:function(){var e=this;e.$refs.distributeBuildingManagerForm.validate(function(t){if(!t)return!1;e.$http({url:"/api/manageSystem/system/manager/building/distributeBuildingManager",method:"patch",data:{buildingId:e.distributeBuildingManagerFormData.buildingId,managerId:e.distributeBuildingManagerFormData.chooseManager}}).then(function(t){"00000"===t.data.code&&(e.$message({message:"分配成功!",type:"success"}),e.handleCloseDistributeBuildingManager(),e.watchQueryFun())}).catch(function(e){console.log(e)})})},handleDistributeBuildingManager:function(e){var t=e.id,a=this;a.distributeBuildingManagerDialogVisible=!0,a.distributeBuildingManagerFormData.buildingId=t}},mounted:function(){this.watchQueryFun(),this.getSimpleManagerList()},watch:{"$route.query.currentPage":function(){this.watchQueryFun()}}}}});