webpackJsonp([51],{118:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{message:[],closed:!1,timer:null}},watch:{closed:function(e){e&&this.destroyElement()}},methods:{destroyElement:function(){this.$destroy(),this.$el.parentNode.removeChild(this.$el)},startTimer:function(){var e=this;this.timer=setTimeout(function(){e.closed||(e.closed=!0)},2e3)}},mounted:function(){this.startTimer()}}},119:function(e,t){},120:function(e,t,a){function i(e){a(119)}var s=a(65)(a(118),a(121),i,null,null);e.exports=s.exports},121:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{appear:"",name:"zd-message-fade"}},[a("div",{staticClass:"zd-message-wrapper"},[a("div",{staticClass:"zd-message"},e._l(e.message,function(t){return a("p",{staticClass:"zd-message-word"},[e._v(e._s(t))])}))])])},staticRenderFns:[]}},1293:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contain-main"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"搜索分类"}},[a("el-input",{attrs:{size:"small"},model:{value:e.formData.keywords,callback:function(t){e.formData.keywords=t},expression:"formData.keywords"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"search",size:"small"},on:{click:e.searchFun}},[e._v("搜索")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.createClassify}},[e._v("创建分类")])],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",border:"",data:e.tableData}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"url",label:"icon","min-width":"70"}},[void 0],2),e._v(" "),a("el-table-column",{staticStyle:{"text-align":"center"},attrs:{prop:"name",label:"类别","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"编号","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"count",label:"数量","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"310"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){e.AddSpecifications(t.row)}}},[e._v("添加规格")]),e._v(" "),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){e.CheckSpecifications(t.row)}}},[e._v("编辑规格")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"permit",rawName:"v-permit",value:3303,expression:"3303"}],attrs:{"el-button":"",type:"danger",size:"small"},on:{click:function(a){e.deleteCoupon(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",[a("div",{staticClass:"contain-bottom-pagination"},[a("el-pagination",{staticClass:"fr",attrs:{layout:"sizes, total, prev, pager, next, jumper","current-page":e.pageData.currentPage,total:e.pageData.totalSize,"page-sizes":[10,20,50,100],"page-size":e.pageData.pageSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("el-dialog",{attrs:{title:"分类操作",visible:e.dialogFormVisible,"before-close":e.createClassifyOff},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"classifyForm",attrs:{rules:e.classifyFormRules,model:e.classifyForm,"label-width":"150px","label-position":"left"}},[a("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.classifyForm.name,callback:function(t){e.classifyForm.name=t},expression:"classifyForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传分类图标",prop:"icon"}},[a("el-upload",{ref:"icon",staticClass:"editgoodsPic",attrs:{action:"/v1/file","list-type":"picture-card",name:"file",size:"small",accept:"image/*",data:{uploadType:11,fileSuffixType:1},"file-list":e.initImg,"on-success":e.handleFileUpload,"on-preview":e.handlePictureCardPreview,"on-change":e.handleImgChange,"on-remove":e.handleImgChange,"before-upload":e.handleCheckImgLength}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"设置序号",prop:"index",size:"small"}},[a("el-input-number",{model:{value:e.classifyForm.index,callback:function(t){e.classifyForm.index=t},expression:"classifyForm.index"}})],1)],1),e._v(" "),a("el-dialog",{attrs:{size:"tiny"},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}},[a("img",{attrs:{width:"100%",src:e.dialogFormImageUrl,alt:""}})]),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitClassify}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.createClassifyOff}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加规格",visible:e.addSpecifications,width:"400","before-close":e.AddSpecificationsClose},on:{"update:visible":function(t){e.addSpecifications=t}}},[a("el-form",{ref:"SpecificationsForm",attrs:{model:e.classifyForm,"label-width":"90px","label-position":"left"}},[a("el-form-item",{attrs:{label:"规格名称：",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.SpecificationsForm.propertyName,callback:function(t){e.SpecificationsForm.propertyName=t},expression:"SpecificationsForm.propertyName"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{on:{click:function(t){e.addSpecifications=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.AddSpecificationsOk}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"编辑规格",visible:e.checkSpecifications,width:"400","before-close":e.CheckSpecificationsClose},on:{"update:visible":function(t){e.checkSpecifications=t}}},[[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.SpecificationsTableData,border:""}},[a("el-table-column",{attrs:{prop:"propertyName",label:"规格名称"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.SpecificationsDelete(t.row)}}},[e._v("删除")])]}}])})],1)],e._v(" "),a("span",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{on:{click:function(t){e.checkSpecifications=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.checkSpecifications=!1}}},[e._v("确 定")])],1)],2)],1)},staticRenderFns:[]}},372:function(e,t,a){var i=a(65)(a(883),a(1293),null,null,null);e.exports=i.exports},74:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(6),s=function(e){return e&&e.__esModule?e:{default:e}}(i),n=s.default.extend(a(120)),o=function(e){"string"==typeof e&&(e={message:[e]});var t=new n({data:e});return t.vm=t.$mount(),document.body.appendChild(t.vm.$el),t.vm};t.default=o},883:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(74);!function(e){e&&e.__esModule}(i);t.default={data:function(){return{formData:{keywords:""},sendData:{keywords:""},initImg:[],tableData:[],pageData:{currentPage:void 0!==this.$route.query.currentPage?parseInt(this.$route.query.currentPage):1,totalSize:1,pageSize:10},dialogFormVisible:!1,dialogFormImageUrl:"",dialogVisible:!1,classifyForm:{name:"",icon:"",index:"",sortId:"",oldNumber:""},classifyFormRules:{name:[{required:!0,trigger:"change",message:"请输入分类名称"}],icon:[{required:!0,message:"请添加分类图标",trigger:"blur"}],index:[{required:!0,trigger:"blur",message:"请设置序号"}]},type:"",addSpecifications:!1,checkSpecifications:!1,SpecificationsForm:{sortId:"",propertyName:"",nameSort:"0",type:"0"},SpecificationsTableData:[]}},watch:{"$route.query.currentPage":function(){this.watchQueryFun()}},mounted:function(){this.watchQueryFun()},methods:{AddSpecifications:function(e){this.SpecificationsForm.sortId=e.id,this.addSpecifications=!0},CheckSpecifications:function(e){this.GetSpecifications(e)},AddSpecificationsClose:function(){this.addSpecifications=!1},AddSpecificationsOk:function(){var e=this;if(""===this.SpecificationsForm.propertyName)return this.$message({type:"warning",message:"分类名称不能为空"});this.$http({method:"post",url:"/api/manageSystem/system/mall/merchandise/merchandise/createMerchandiseSortProperty",data:this.SpecificationsForm}).then(function(t){"00000"===t.data.code&&e.$message({type:"success",message:"添加成功!"}),e.addSpecifications=!1}).catch(function(e){})},CheckSpecificationsClose:function(){this.checkSpecifications=!1},GetSpecifications:function(e){var t=this;this.$http({method:"get",url:"/api/manageSystem/system/mall/merchandise/merchandise/getMerchandiseSortProperyList?sortId="+e.id}).then(function(e){"00000"===e.data.code&&(t.SpecificationsTableData=e.data.data,t.checkSpecifications=!0)}).catch(function(e){})},SpecificationsDelete:function(e){var t=this,a=this.SpecificationsTableData.indexOf(e);this.$http({method:"delete",url:"/api/manageSystem/system/mall/merchandise/merchandise/deleteMerchandiseSortProperty?propetyId="+e.id}).then(function(e){"00000"===e.data.code&&(t.SpecificationsTableData.splice(a,1),0===t.SpecificationsTableData.length&&(t.checkSpecifications=!1),t.$message({type:"success",message:"删除成功!"}))}).catch(function(e){})},handlePictureCardPreview:function(e){this.dialogFormImageUrl=e.url,this.dialogVisible=!0},handleCheckImgLength:function(e){return!1===/(.(jpg|gif|jpeg|png))+$/i.test(e.name)?(this.$alert("请上传正确格式的图片","提示"),!1):this.$refs.icon.uploadFiles.length>1?(this.$alert("限上传一张图片","提示"),!1):void 0},handleImgChange:function(e,t){for(var a=[],i=0;i<t.length;i++)!0===Object.prototype.hasOwnProperty.call(t[i],"response")&&a.push(t[i].response.returnData.data.filePath);this.classifyForm.icon=a.join()},handleFileUpload:function(e,t,a){if(1e4!==e.code||1e4!==e.returnData.subCode)if("E0004"===e.code)this.$router.push("/manageSystem/login");else{this.$alert(e.message,"提示",{confirmButtonText:"确定"});for(var i=0;i<a.length;i++)if(a[i]===t){a.splice(i,1);break}}},handleSubmitClassify:function(){var e=this;"edit"==this.type?this.$http({method:"patch",url:"/api/manageSystem/system/mall/merchandise/merchandise/editMerchandiseSort",data:{name:this.classifyForm.name,newNumber:this.classifyForm.index,oldNumber:this.classifyForm.oldNumber,sortId:this.classifyForm.sortId,url:this.classifyForm.icon}}).then(function(t){"00000"===t.data.code&&(e.$message({type:"success",message:"编辑成功!"}),e.createClassifyOff(),e.watchQueryFun())}).catch(function(e){}):"add"==this.type&&this.$http({method:"post",url:"/api/manageSystem/system/mall/merchandise/merchandise/createMerchandiseSort",data:{name:this.classifyForm.name,number:this.classifyForm.index,url:this.classifyForm.icon}}).then(function(t){"00000"===t.data.code&&(e.$message({type:"success",message:"添加成功!"}),e.createClassifyOff(),e.watchQueryFun())}).catch(function(e){console.log(e)})},createClassifyOff:function(){this.classifyForm.name="",this.classifyForm.index="",this.initImg=[],this.dialogFormVisible=!1},createClassify:function(){this.type="add",this.dialogFormVisible=!0},watchQueryFun:function(){this.$route.query.currentPage?this.pageData.currentPage=parseInt(this.$route.query.currentPage):this.pageData.currentPage=1,this.ajaxFun()},ajaxFun:function(){var e=this;this.$http({method:"get",url:"/api/manageSystem/system/mall/merchandise/merchandise/getMerchandiseSortList",params:{pageNo:this.pageData.currentPage,pageSize:this.pageData.pageSize,keywords:this.sendData.keywords}}).then(function(t){"00000"===t.data.code&&(e.pageData.totalSize=t.data.count,e.tableData=t.data.sortList,e.tableData.forEach(function(e){e.initImg=[{name:"content",url:e.hostUrl}]}))}).catch(function(e){console.log(e)})},handleSizeChange:function(e){this.pageData.pageSize=e,this.$route.query.currentPage?this.$router.push({path:"/manageSystem/mall/classify"}):this.$router.push({path:"/manageSystem/mall/classify",query:{currentPage:1}})},handleCurrentChange:function(e){this.$router.push({path:"/manageSystem/mall/classify",query:{currentPage:e}})},searchFun:function(){this.sendData.keywords=this.formData.keywords,this.$route.query.currentPage?this.$router.push({path:"/manageSystem/mall/classify"}):this.$router.push({path:"/manageSystem/mall/classify",query:{currentPage:1}})},handleEdit:function(e){this.type="edit",this.classifyForm.oldNumber=e.number,this.classifyForm.name=e.name,this.classifyForm.index=e.number,this.classifyForm.icon=e.url,this.classifyForm.sortId=e.id,this.initImg=e.initImg,this.dialogFormVisible=!0},deleteCoupon:function(e){var t=this;this.$confirm("此操作将永久删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:"/api/manageSystem/system/mall/merchandise/merchandise/deleteMerchandiseSort",params:{sortId:e},method:"delete"}).then(function(e){"00000"===e.data.code&&(t.$message({type:"success",message:"删除成功!"}),t.searchFun())}).catch(function(e){})})}}}}});