webpackJsonp([28],{1108:function(e,t){},118:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{message:[],closed:!1,timer:null}},watch:{closed:function(e){e&&this.destroyElement()}},methods:{destroyElement:function(){this.$destroy(),this.$el.parentNode.removeChild(this.$el)},startTimer:function(){var e=this;this.timer=setTimeout(function(){e.closed||(e.closed=!0)},2e3)}},mounted:function(){this.startTimer()}}},119:function(e,t){},120:function(e,t,a){function i(e){a(119)}var r=a(65)(a(118),a(121),i,null,null);e.exports=r.exports},121:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{appear:"",name:"zd-message-fade"}},[a("div",{staticClass:"zd-message-wrapper"},[a("div",{staticClass:"zd-message"},e._l(e.message,function(t){return a("p",{staticClass:"zd-message-word"},[e._v(e._s(t))])}))])])},staticRenderFns:[]}},1295:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contain-main addgoods"},[a("div",{staticClass:"addgoods-contain"},[e._m(0),e._v(" "),a("el-form",{ref:"formData",staticClass:"scoped-form",attrs:{model:e.formData,rules:e.formRules,"label-width":"95px","label-position":"left"}},[a("div",{staticClass:"addgoods-input"},[a("el-form-item",{attrs:{label:"商品名称:",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入商品价格"},model:{value:e.formData.name,callback:function(t){e.formData.name=t},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"原价(元):","label-width":"75px",prop:"price"}},[a("el-input",{attrs:{placeholder:"请输入原价"},model:{value:e.formData.price,callback:function(t){e.formData.price=t},expression:"formData.price"}})],1)],1),e._v(" "),a("div",{staticClass:"addgoods-input"},[a("el-form-item",{attrs:{label:"单买价格(元):",prop:"specialPrice"}},[a("el-input",{attrs:{placeholder:"请输入单买价格"},model:{value:e.formData.specialPrice,callback:function(t){e.formData.specialPrice=t},expression:"formData.specialPrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"净含量:","label-width":"75px",prop:"content"}},[a("el-input",{attrs:{placeholder:"请输入净含量"},model:{value:e.formData.content,callback:function(t){e.formData.content=t},expression:"formData.content"}})],1)],1),e._v(" "),a("div",{staticClass:"addgoods-inputcount"},[a("el-form-item",{attrs:{label:"商品详情:",prop:"description"}},[a("el-input",{attrs:{placeholder:"请输入商品详情"},model:{value:e.formData.description,callback:function(t){e.formData.description=t},expression:"formData.description"}})],1),e._v(" "),a("el-form-item",{staticClass:"addgoods-input-count",attrs:{label:"单买最多购买份数:","label-width":"140px",prop:"maxQuantity"}},[a("el-input",{staticClass:"addgoods-input-countdes",attrs:{prop:"maxQuantity"},model:{value:e.formData.maxQuantity,callback:function(t){e.formData.maxQuantity=t},expression:"formData.maxQuantity"}}),e._v(" "),a("span",[e._v("份")])],1)],1),e._v(" "),a("div",{staticClass:"addgoods-input"},[a("el-form-item",{attrs:{label:"商品分类:",prop:"sortId"}},[a("el-select",{attrs:{placeholder:"请选择商品分类"},model:{value:e.formData.sortId,callback:function(t){e.formData.sortId=t},expression:"formData.sortId"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),0!==e.formData.sortId?a("div",{staticClass:"addgoods-input"},[a("el-form-item",{attrs:{label:"商品规格:"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addSpecs}},[e._v("添加规格 ")]),e._v(" "),e._l(e.specs,function(t,i){return a("el-form-item",{key:i},[e._l(t,function(i,r,n){return"id"!==r?a("div",{key:n,staticClass:"el-input el-input--small",staticStyle:{width:"240px"}},[a("span",[e._v(e._s("price"===r?"价格：":r+"："))]),e._v(" "),a("el-input",{staticStyle:{width:"160px"},attrs:{type:"text",placeholder:"请输入属性值"},model:{value:t[r],callback:function(e){var a=t,i=r;Array.isArray(a)?a.splice(i,1,e):t[r]=e},expression:"item[key]"}})],1):e._e()}),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){a.preventDefault(),e.removeDomain(i,t)}}},[e._v("删除")])],2)})],2)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"商品图片:"}},[a("el-upload",{ref:"uploadImg",staticClass:"editgoodsPic",attrs:{action:"/v1/file","list-type":"picture-card",name:"file",accept:"image/*","file-list":e.initImg,data:{uploadType:11,fileSuffixType:1},"on-success":e.handleFileUpload,"on-preview":e.handlePictureCardPreview,"on-change":e.handleImgChange,"on-remove":e.handleImgChange,"before-upload":e.handleCheckImgLength}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"商品详情:"}},[a("el-upload",{ref:"uploadDetailImg",attrs:{action:"/v1/file","list-type":"picture-card",name:"file","file-list":e.initDetailImg,accept:"image/*",data:{uploadType:11,fileSuffixType:1},"on-success":e.handleFileUpload,"on-preview":e.handlePictureCardPreview,"on-change":e.handleDetailImgChange,"on-remove":e.handleDetailImgChange,"before-upload":e.handleClearBeforeDetailImg}},[a("span",[e._v("更改图片")])])],1),e._v(" "),a("div",{staticClass:"addgoods-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:e.handleCancel}},[e._v("返回")])],1)],1),e._v(" "),a("el-dialog",{attrs:{size:"tiny"},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contain-title"},[a("span",[e._v("编辑商品")])])}]}},378:function(e,t,a){function i(e){a(1108)}var r=a(65)(a(889),a(1295),i,"data-v-b1ae62b4",null);e.exports=r.exports},74:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(6),r=function(e){return e&&e.__esModule?e:{default:e}}(i),n=r.default.extend(a(120)),s=function(e){"string"==typeof e&&(e={message:[e]});var t=new n({data:e});return t.vm=t.$mount(),document.body.appendChild(t.vm.$el),t.vm};t.default=s},795:function(e,t,a){e.exports={default:a(796),__esModule:!0}},796:function(e,t,a){var i=a(32),r=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},829:function(e,t,a){e.exports={default:a(832),__esModule:!0}},832:function(e,t,a){a(834),e.exports=a(32).Object.keys},833:function(e,t,a){var i=a(41),r=a(32),n=a(29);e.exports=function(e,t){var a=(r.Object||{})[e]||Object[e],s={};s[e]=t(a),i(i.S+i.F*n(function(){a(1)}),"Object",s)}},834:function(e,t,a){var i=a(69),r=a(30);a(833)("keys",function(){return function(e){return r(i(e))}})},889:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(829),n=i(r),s=a(795),o=i(s),l=a(74);i(l);t.default={data:function(){var e=this,t=function(t,a,i){0===e.formData.imgList.length?i(new Error("请添加商品图片")):i()},a=function(e,t,a){return""==t?a(new Error("请输入商品名称")):t.toString().length>50?a(new Error("限制50字以内")):void a()},i=function(e,t,a){if(""==t)return a(new Error("请输入净含量"));a()},r=function(e,t,a){var i=t,r=i.toString().replace(/[^\d\.]/g,"");-1!=r.indexOf(".")&&r.split(".")[1].length>1&&(r=r.split(".")[0]+"."+r.split(".")[1].substr(0,2)),r=r>99999.99?99999.99:r,i!=r?a(new Error("限制100000.00元以内")):a()};return{options:[{value:0,label:"暂无分类"}],ruleForm2:{pass:"",count:"",age:""},initImg:[],initDetailImg:[{name:"content",url:""}],fileList1:[],fileList2:[],formData:{name:"",price:"",specialPrice:"",content:"",description:"",imgList:[],detailImg:"",maxQuantity:"",sortId:""},specs:[],formRules:{name:[{validator:a,trigger:"blur"}],price:[{validator:r,trigger:"blur"}],specialPrice:[{validator:r,trigger:"blur"}],content:[{validator:i,trigger:"blur"}],maxQuantity:[{validator:function(e,t,a){return-1!==t.toString().indexOf(".")?a(new Error("请输入整数")):t<1e3&&t>0?void a():a(new Error("限制1000份"))},trigger:"blur"}],description:[{min:1,max:500,message:"限制500字以内",trigger:"blur"}],imgList:[{type:"array",required:!0,message:"请添加商品图片",trigger:"blur"},{validator:t,trigger:"blur"}],detailImg:[{required:!0,message:"请添加商品详情图片",trigger:"blur"}],specs:[{type:"array"}]},dialogVisible:!1,dialogImageUrl:""}},methods:{removeDomain:function(e,t){var a=this;""===t.price?this.specs.splice(e,1):(this.specs.splice(e,1),this.$http({url:"/api/manageSystem/system/mall/merchandise/merchandise/deleteMerchandiseSpecs?specsId="+t.id,method:"delete"}).then(function(e){"00000"===e.data.code&&a.$message("删除成功")}).catch(function(e){}))},addSpecs:function(){if(this.specs.length>0){var e=(0,o.default)(this.specs[0]),t=JSON.parse(e);delete t.id,(0,n.default)(t).forEach(function(e,a){t[e]=""}),this.specs.push(t)}},limitNumber:function(){var e=this.formData.maxQuantity;this.formData.maxQuantity=parseInt(this.formData.maxQuantity)||1,this.formData.maxQuantity=(this.formData.maxQuantity,100),e!=this.formData.maxQuantity&&this.$message("请输1-100的正整数")},handleFileUpload:function(e,t,a){if(1e4!==e.code||1e4!==e.returnData.subCode)if("E0004"===e.code)this.$router.push("/manageSystem/login");else{this.$alert(e.message,"错误",{confirmButtonText:"确定"});for(var i=0;i<a.length;i++)if(a[i]===t){a.splice(i,1);break}}},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},handleDetailImgChange:function(e,t){this.formData.detailImg="";for(var a=0;a<t.length;a++)if(!0===Object.prototype.hasOwnProperty.call(t[a],"response")){this.formData.detailImg=t[a].response.returnData.data.filePath;break}},handleImgChange:function(e,t){for(var a=[],i=0;i<t.length;i++)"success"===t[i].status&&(!0===Object.prototype.hasOwnProperty.call(t[i],"response")?a.push(t[i].response.returnData.data.filePath):a.push(t[i].urlNoHostname));this.formData.imgList=a},handleClearBeforeDetailImg:function(e){if(!1===/(.(jpg|gif|jpeg|png))+$/i.test(e.name))return this.$alert("请上传正确格式的图片","提示"),!1;this.$refs.uploadDetailImg.uploadFiles.length>1&&this.$refs.uploadDetailImg.handleRemove(this.$refs.uploadDetailImg.uploadFiles[0])},handleCheckImgLength:function(e){return!1===/(.(jpg|gif|jpeg|png))+$/i.test(e.name)?(this.$alert("请上传正确格式的图片","提示"),!1):this.$refs.uploadImg.uploadFiles.length>6?(this.$alert("限上传六张图片","提示"),!1):void 0},handleSubmit:function(){var e=this,t=[];this.specs.forEach(function(e){var a={spece:"",price:e.price};e.id&&delete e.id,a.spece=JSON.parse((0,o.default)(e)),delete a.spece.price,t.push(a)}),this.$refs.formData.validate(function(a){if(!a)return!1;e.$http({url:"/api/manageSystem/system/mall/merchandise/merchandise/editMerchandise",method:"patch",data:{id:e.$route.query.id,name:e.formData.name,price:e.formData.price,content:e.formData.content,description:e.formData.description,imgList:e.formData.imgList,detailImg:e.formData.detailImg,specialPrice:e.formData.specialPrice,maxQuantity:e.formData.maxQuantity,sortId:e.formData.sortId,specification:str,specsList:(0,o.default)(t)}}).then(function(t){"00000"===t.data.code&&e.$message("编辑成功")}).catch(function(e){})})},handleCancel:function(){this.$router.push("/manageSystem/mall/merchandise/merchandise")}},mounted:function(){var e=this,t=this;this.$http({url:"/api/manageSystem/system/mall/merchandise/merchandise/getMerchandiseInfo",params:{id:this.$route.query.id}}).then(function(a){if("00000"===a.data.code){e.initDetailImg[0].url=a.data.merchandiseInfo.detailImg;for(var i=0;i<a.data.merchandiseInfo.img.length;i++){var r={name:"content"+i,url:a.data.merchandiseInfo.img[i],urlNoHostname:a.data.merchandiseInfo.imgNoHostname[i]};e.initImg.push(r)}if(a.data.merchandiseInfo.specsList.length>0){var n=a.data.merchandiseInfo.specsList;t.specs=n}e.formData=a.data.merchandiseInfo,e.formData.imgList=a.data.merchandiseInfo.imgNoHostname,e.formData.detailImg=a.data.merchandiseInfo.detailImgNoHostname}}).catch(function(e){console.log(e)}),this.$http({url:"/api/manageSystem/system/mall/merchandise/merchandise/getMerchandiseSortLists",params:{keywords:""}}).then(function(t){"00000"==t.data.code&&t.data.sortList.forEach(function(t){var a={value:t.id,label:t.name};e.options.push(a)})}).catch(function(e){})}}}});