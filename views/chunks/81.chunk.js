webpackJsonp([81],{1176:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contain-main"},[t._m(0),t._v(" "),a("el-form",{ref:"formData",staticClass:"scoped-form",attrs:{model:t.formData,rules:t.formRules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{label:"券种类",prop:"type"}},[a("el-select",{model:{value:t.formData.type,callback:function(e){t.formData.type=e},expression:"formData.type"}},[a("el-option",{attrs:{label:"商城券",value:1}}),t._v(" "),a("el-option",{attrs:{label:"生活券",value:2}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"优惠种类",prop:"preferentialType"}},[a("el-select",{model:{value:t.formData.preferentialType,callback:function(e){t.formData.preferentialType=e},expression:"formData.preferentialType"}},[a("el-option",{attrs:{label:"满减券",value:1}}),t._v(" "),a("el-option",{attrs:{label:"折扣券",disabled:2==t.formData.type,value:2}}),t._v(" "),a("el-option",{attrs:{label:"兑换券",disabled:2==t.formData.type,value:3}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"数量",prop:"quantity",required:""}},[a("el-input-number",{attrs:{min:0},model:{value:t.formData.quantity,callback:function(e){t.formData.quantity=t._n(e)},expression:"formData.quantity"}}),t._v(" "),a("div",[3===t.formData.preferentialType?a("label",{staticClass:"el-form-item__label",staticStyle:{width:"400px"},attrs:{for:"quantity"}},[t._v("优惠券数量对应相同数量的兑换码")]):t._e()])],1),t._v(" "),a("el-form-item",{attrs:{label:"特定商品",prop:"specificGoods",required:""}},[a("el-cascader",{attrs:{options:t.options,placeholder:"请选择指定商品"},on:{"active-item-change":t.handleItemChange},model:{value:t.formData.specificGoods,callback:function(e){t.formData.specificGoods=e},expression:"formData.specificGoods"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"用券最小金额",prop:"amountCondition",required:""}},[a("el-input",{model:{value:t.formData.amountCondition,callback:function(e){t.formData.amountCondition=t._n(e)},expression:"formData.amountCondition"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"优惠金额",prop:"discountAmount",required:""}},[a("el-input",{model:{value:t.formData.discountAmount,callback:function(e){t.formData.discountAmount=t._n(e)},expression:"formData.discountAmount"}})],1),t._v(" "),2===t.formData.preferentialType?a("el-form-item",{attrs:{label:"最大优惠金额",prop:"maxDiscountAmount",required:""}},[a("el-input",{model:{value:t.formData.maxDiscountAmount,callback:function(e){t.formData.maxDiscountAmount=t._n(e)},expression:"formData.maxDiscountAmount"}}),t._v(" "),a("span",{staticClass:"scoped-remark"},[t._v("最大优惠金额为0时则无优惠上限")])],1):t._e(),t._v(" "),2===t.formData.preferentialType?a("el-form-item",{attrs:{label:"折扣",prop:"discountPercent",required:""}},[a("el-input",{model:{value:t.formData.discountPercent,callback:function(e){t.formData.discountPercent=t._n(e)},expression:"formData.discountPercent"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"发券时间",prop:"startDatetime"}},[a("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss"},model:{value:t.formData.startDatetime,callback:function(e){t.formData.startDatetime=e},expression:"formData.startDatetime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"过期时间",prop:"endDatetime"}},[a("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss"},model:{value:t.formData.endDatetime,callback:function(e){t.formData.endDatetime=e},expression:"formData.endDatetime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3},maxlength:500},model:{value:t.formData.description,callback:function(e){t.formData.description=e},expression:"formData.description"}})],1),t._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"permit",rawName:"v-permit",value:3301,expression:"3301"}],attrs:{type:"primary",size:"small"},on:{click:t.handleSubmit}},[t._v("提交")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:t.handleCancel}},[t._v("返回")])],1)],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contain-title"},[a("span",[t._v("添加优惠券")])])}]}},374:function(t,e,a){function r(t){a(999)}var o=a(65)(a(885),a(1176),r,"data-v-012d4e20",null);t.exports=o.exports},785:function(t,e,a){"use strict";function r(t,e){if(""==t||null==t)return"";var a=new Date(t),r=a.getFullYear(),o=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,n=a.getDate()<10?"0"+a.getDate():a.getDate(),i=r+"-"+o+"-"+n,s=a.getHours()<10?"0"+a.getHours():a.getHours(),l=a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes(),m=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();return"datetime"===e?i=i+" "+s+":"+l+":"+m:"minute"===e&&(i=i+" "+s+":"+l),i}Object.defineProperty(e,"__esModule",{value:!0}),e.transition=r},885:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(785);e.default={data:function(){var t=this;return{typeList:[],formData:{preferentialType:"",type:"",quantity:"",amountCondition:"",discountAmount:"",discountPercent:"",maxDiscountAmount:"",startDatetime:"",endDatetime:"",description:"",specificGoods:[]},formRules:{preferentialType:[{type:"number",required:!0,message:"请选择优惠种类",trigger:"blur"}],type:[{type:"number",required:!0,message:"请选择券种类",trigger:"blur"}],quantity:[{validator:function(t,e,a){e?e<=0?a(new Error("请输入大于0的数量")):a():a(new Error("请输入数量"))},trigger:"blur"}],amountCondition:[{validator:function(t,e,a){""===e?a(new Error("请输入用券最小金额")):e<0?a(new Error("请输入大于0的金额")):a()},trigger:"blur"}],specificGoods:[{type:"array"}],discountAmount:[{validator:function(e,a,r){1===t.formData.preferentialType?a?a<0?r(new Error("请输入大于0的金额")):r():r(new Error("请输入优惠金额")):r()},trigger:"blur"}],discountPercent:[{validator:function(e,a,r){2===t.formData.preferentialType?a?a<0||a>1?r(new Error("请输入0-1之间的数字")):r():r(new Error("请输入优惠折扣")):r()},trigger:"change"}],maxDiscountAmount:[{validator:function(e,a,r){2===t.formData.preferentialType?""===a?r(new Error("请输入最大优惠金额")):a<0?r(new Error("请输入大于0的金额")):r():r()},trigger:"blur"}],startDatetime:[{type:"date",required:!0,message:"请选择发券日期时间",trigger:"blur"}],endDatetime:[{type:"date",required:!0,message:"请选择过期日期时间",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]},options:[{value:"0",label:"无特定商品"}]}},methods:{handleSubmit:function(){var t=this;this.$refs.formData.validate(function(e){if(!e)return!1;t.$http({url:"/api/manageSystem/system/mall/coupon/createCoupon",method:"post",data:{preferentialType:t.formData.preferentialType,type:t.formData.type,quantity:t.formData.quantity,amountCondition:t.formData.amountCondition,face:1===t.formData.preferentialType?t.formData.discountAmount:t.formData.discountPercent,maxDiscountAmount:t.formData.maxDiscountAmount?t.formData.maxDiscountAmount:t.formData.discountAmount,startDatetime:(0,r.transition)(t.formData.startDatetime),endDatetime:(0,r.transition)(t.formData.endDatetime),description:t.formData.description,sortId:t.formData.specificGoods[0],merchandiseId:t.formData.specificGoods[1]?t.formData.specificGoods[1]:0}}).then(function(e){"00000"===e.data.code&&(t.$message("添加成功"),t.$router.push("/manageSystem/mall/coupon"))}).catch(function(t){})})},handleCancel:function(){this.$router.push("/manageSystem/mall/coupon")},handleItemChange:function(t){var e=this;this.$http({url:"/api/manageSystem/system/mall/merchandise/merchandise/getMerchandiseListBySortId",params:{sortId:t[0]}}).then(function(a){if("00000"==a.data.code){e.options.forEach(function(e){var r=[];e.value==t&&a.data.data.forEach(function(t){var a={value:t.id,label:t.name};r.push(a),e.children=r})})}}).catch(function(t){})}},mounted:function(){var t=this;this.$http({url:"/api/manageSystem/system/mall/merchandise/merchandise/getMerchandiseSortLists",params:{keywords:""}}).then(function(e){"00000"==e.data.code&&e.data.sortList.forEach(function(e){var a={value:e.id,label:e.name,children:[]};t.options.push(a)})}).catch(function(t){})}}},999:function(t,e){}});