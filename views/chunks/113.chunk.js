webpackJsonp([113],{1128:function(t,e){},1318:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contain-main"},[t._m(0),t._v(" "),a("el-form",{ref:"formData",staticClass:"scoped-form",attrs:{model:t.formData,rules:t.formRules,"label-width":"130px","label-position":"left",inline:""}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系人：",prop:"contact"}},[a("el-input",{attrs:{size:"small"},model:{value:t.formData.contact,callback:function(e){t.formData.contact=e},expression:"formData.contact"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系方式：",required:"",prop:"cellphone"}},[a("el-input",{attrs:{size:"small"},model:{value:t.formData.cellphone,callback:function(e){t.formData.cellphone=e},expression:"formData.cellphone"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"标题：",prop:"title"}},[a("el-input",{attrs:{size:"small",maxlength:45},model:{value:t.formData.title,callback:function(e){t.formData.title=e},expression:"formData.title"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"内容：",prop:"content"}},[a("el-input",{attrs:{type:"textarea",size:"small",autosize:{minRows:3},maxlength:500},model:{value:t.formData.content,callback:function(e){t.formData.content=e},expression:"formData.content"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"上传图片：",prop:"imgList"}},[a("el-upload",{ref:"uploadImg",attrs:{action:"/v1/file","list-type":"picture-card",name:"file",accept:"image/*","file-list":t.initImgList,data:{uploadType:5,fileSuffixType:1},"on-success":t.handleFileUpload,"on-preview":t.handlePictureCardPreview,"on-change":t.handleImgChange,"on-remove":t.handleImgChange,"before-upload":t.handleCheckImgLength}},[a("i",{staticClass:"el-icon-plus"},[a("span",{staticClass:"description"},[t._v("最多上传9张图片")])])])],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleAddAnnouncement}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:t.handleReturn}},[t._v("返回")])],1)],1),t._v(" "),a("el-dialog",{attrs:{size:"tiny"},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contain-title"},[a("span",[t._v("编辑公告")])])}]}},398:function(t,e,a){function n(t){a(1128)}var o=a(65)(a(910),a(1318),n,"data-v-fbd61442",null);t.exports=o.exports},910:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){var t=function(t,e,a){if(""===e)a(new Error("请输入联系方式"));else{!1===/^1(([3,8]\d)|(5[0-3,5-9])|(47)|(7[5-8]))(\d{8})$/.test(e)?a(new Error("请输入正确的手机号")):a()}};return{dialogVisible:!1,dialogImageUrl:"",initImgList:[],formData:{id:this.$route.query.id,contact:"",cellphone:"",title:"",content:"",imgList:[]},formRules:{contact:[{required:!0,message:"请输入联系人",trigger:"blur"}],cellphone:[{validator:t,trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]}}},methods:{handleFileUpload:function(t,e,a){if(1e4!==t.code||1e4!==t.returnData.subCode)if("E0004"===t.code)this.$router.push("/manageSystem/login");else{this.$alert(t.message,"提示",{confirmButtonText:"确定"});for(var n=0;n<a.length;n++)if(a[n]===e){a.splice(n,1);break}}},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleImgChange:function(t,e){for(var a=[],n=0;n<e.length;n++)"success"===e[n].status&&(!0===Object.prototype.hasOwnProperty.call(e[n],"response")?a.push(e[n].response.returnData.data.filePath):a.push(e[n].urlNoHostname));this.formData.imgList=a},handleCheckImgLength:function(t){return!1===/(.(jpg|gif|jpeg|png))+$/i.test(t.name)?(this.$alert("请上传正确格式的图片","提示"),!1):this.$refs.uploadImg.uploadFiles.length>9?(this.$alert("限上传九张图片","提示"),!1):void 0},handleReturn:function(){this.$router.push("/manageSystem/property/announcement")},handleAddAnnouncement:function(){var t=this;this.$refs.formData.validate(function(e){if(!e)return!1;t.$http({url:"/api/manageSystem/system/property/announcement/editAnnouncement",method:"patch",data:t.formData}).then(function(e){"00000"===e.data.code&&(t.$message("编辑成功"),t.$router.push("/manageSystem/property/announcement"))}).catch(function(t){console.log(t)})})}},mounted:function(){var t=this;this.$http({url:"/api/manageSystem/system/property/announcement/getAnnouncementInfo",params:{id:this.$route.query.id}}).then(function(e){if("00000"===e.data.code){for(var a=0;a<e.data.announcementInfo.imgList.length;a++){var n={name:"content"+a,url:e.data.announcementInfo.imgList[a],urlNoHostname:e.data.announcementInfo.imgListNoHostname[a]};t.initImgList.push(n)}t.formData.contact=e.data.announcementInfo.contact,t.formData.cellphone=e.data.announcementInfo.cellphone,t.formData.title=e.data.announcementInfo.title,t.formData.content=e.data.announcementInfo.content,t.formData.imgList=e.data.announcementInfo.imgListNoHostname}}).catch(function(t){console.log(t)})}}}});